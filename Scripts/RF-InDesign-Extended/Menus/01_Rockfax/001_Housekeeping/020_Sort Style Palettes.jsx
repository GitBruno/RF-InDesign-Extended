#target "InDesign";$.level = 0;if (typeof(EXTENDABLES) === 'undefined') {#include "../../../Extendables/extendables.jsx";}if (typeof(preferences) == 'undefined') {preferences = require("preferences");}if (typeof(rfidx) == 'undefined') {rfidx = require("rockfaxidx");}app.scriptPreferences.enableRedraw = false;app.doScript ('main();', undefined, undefined, UndoModes.entireScript, "Update Style Panels Order");function main () {  var store = preferences.Store("update_styles_prefs.json");  var keys = store.data.keys();  for (var i = 0; i < keys.length; i++) {    var orderListFile = rfidx.filesMatching("update_{}_order".format([keys[i]]))[0];    orderListFile.open('r');    var orderListString = orderListFile.read();    orderListFile.close();    moveStyles(orderListString, keys[i]);  }}function moveStyles (orderListString, styleType) {  var orderList = orderListString.split(/\n/);  for (var j = 0; j < app.documents.length; j++) {    var doc = app.documents[j];    for (var i = orderList.length - 1; i >= 0; i--) {      var theStyle = orderList[i];      try{        $.level = 0;        var style = doc[styleType].item(theStyle);         if (typeof(style) == 'undefined') {          alert(theStyle)          }        if (["[None]", "[Basic Graphics Frame]", "[Basic Text Frame]", "[Basic Grid]"].indexOf(theStyle) != -1) {          continue          }        doc[styleType].item(theStyle).move(LocationOptions.AT_BEGINNING);      }catch(e){}    }  }}